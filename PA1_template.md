---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```r
unzip(zipfile = "activity.zip")
data <- read.csv("activity.csv")
head(data, 2)
```

```
##   steps       date interval
## 1    NA 2012-10-01        0
## 2    NA 2012-10-01        5
```

## What is mean total number of steps taken per day?

```r
totalsteps <- data.frame(totalSteps=tapply(data$steps, data$date, sum, na.rm=TRUE))
totalsteps
```

```
##            totalSteps
## 2012-10-01          0
## 2012-10-02        126
## 2012-10-03      11352
## 2012-10-04      12116
## 2012-10-05      13294
## 2012-10-06      15420
## 2012-10-07      11015
## 2012-10-08          0
## 2012-10-09      12811
## 2012-10-10       9900
## 2012-10-11      10304
## 2012-10-12      17382
## 2012-10-13      12426
## 2012-10-14      15098
## 2012-10-15      10139
## 2012-10-16      15084
## 2012-10-17      13452
## 2012-10-18      10056
## 2012-10-19      11829
## 2012-10-20      10395
## 2012-10-21       8821
## 2012-10-22      13460
## 2012-10-23       8918
## 2012-10-24       8355
## 2012-10-25       2492
## 2012-10-26       6778
## 2012-10-27      10119
## 2012-10-28      11458
## 2012-10-29       5018
## 2012-10-30       9819
## 2012-10-31      15414
## 2012-11-01          0
## 2012-11-02      10600
## 2012-11-03      10571
## 2012-11-04          0
## 2012-11-05      10439
## 2012-11-06       8334
## 2012-11-07      12883
## 2012-11-08       3219
## 2012-11-09          0
## 2012-11-10          0
## 2012-11-11      12608
## 2012-11-12      10765
## 2012-11-13       7336
## 2012-11-14          0
## 2012-11-15         41
## 2012-11-16       5441
## 2012-11-17      14339
## 2012-11-18      15110
## 2012-11-19       8841
## 2012-11-20       4472
## 2012-11-21      12787
## 2012-11-22      20427
## 2012-11-23      21194
## 2012-11-24      14478
## 2012-11-25      11834
## 2012-11-26      11162
## 2012-11-27      13646
## 2012-11-28      10183
## 2012-11-29       7047
## 2012-11-30          0
```

```r
hist(totalsteps$totalSteps)
```

![](PA1_template_files/figure-html/mean-1.png)<!-- -->

```r
meansteps <- data.frame(meanSteps=tapply(data$steps, data$date, mean, na.rm=TRUE))
meansteps
```

```
##             meanSteps
## 2012-10-01        NaN
## 2012-10-02  0.4375000
## 2012-10-03 39.4166667
## 2012-10-04 42.0694444
## 2012-10-05 46.1597222
## 2012-10-06 53.5416667
## 2012-10-07 38.2465278
## 2012-10-08        NaN
## 2012-10-09 44.4826389
## 2012-10-10 34.3750000
## 2012-10-11 35.7777778
## 2012-10-12 60.3541667
## 2012-10-13 43.1458333
## 2012-10-14 52.4236111
## 2012-10-15 35.2048611
## 2012-10-16 52.3750000
## 2012-10-17 46.7083333
## 2012-10-18 34.9166667
## 2012-10-19 41.0729167
## 2012-10-20 36.0937500
## 2012-10-21 30.6284722
## 2012-10-22 46.7361111
## 2012-10-23 30.9652778
## 2012-10-24 29.0104167
## 2012-10-25  8.6527778
## 2012-10-26 23.5347222
## 2012-10-27 35.1354167
## 2012-10-28 39.7847222
## 2012-10-29 17.4236111
## 2012-10-30 34.0937500
## 2012-10-31 53.5208333
## 2012-11-01        NaN
## 2012-11-02 36.8055556
## 2012-11-03 36.7048611
## 2012-11-04        NaN
## 2012-11-05 36.2465278
## 2012-11-06 28.9375000
## 2012-11-07 44.7326389
## 2012-11-08 11.1770833
## 2012-11-09        NaN
## 2012-11-10        NaN
## 2012-11-11 43.7777778
## 2012-11-12 37.3784722
## 2012-11-13 25.4722222
## 2012-11-14        NaN
## 2012-11-15  0.1423611
## 2012-11-16 18.8923611
## 2012-11-17 49.7881944
## 2012-11-18 52.4652778
## 2012-11-19 30.6979167
## 2012-11-20 15.5277778
## 2012-11-21 44.3993056
## 2012-11-22 70.9270833
## 2012-11-23 73.5902778
## 2012-11-24 50.2708333
## 2012-11-25 41.0902778
## 2012-11-26 38.7569444
## 2012-11-27 47.3819444
## 2012-11-28 35.3576389
## 2012-11-29 24.4687500
## 2012-11-30        NaN
```

```r
mediansteps <- data.frame(medianSteps=tapply(data$steps, data$date, median, na.rm=TRUE))
mediansteps
```

```
##            medianSteps
## 2012-10-01          NA
## 2012-10-02           0
## 2012-10-03           0
## 2012-10-04           0
## 2012-10-05           0
## 2012-10-06           0
## 2012-10-07           0
## 2012-10-08          NA
## 2012-10-09           0
## 2012-10-10           0
## 2012-10-11           0
## 2012-10-12           0
## 2012-10-13           0
## 2012-10-14           0
## 2012-10-15           0
## 2012-10-16           0
## 2012-10-17           0
## 2012-10-18           0
## 2012-10-19           0
## 2012-10-20           0
## 2012-10-21           0
## 2012-10-22           0
## 2012-10-23           0
## 2012-10-24           0
## 2012-10-25           0
## 2012-10-26           0
## 2012-10-27           0
## 2012-10-28           0
## 2012-10-29           0
## 2012-10-30           0
## 2012-10-31           0
## 2012-11-01          NA
## 2012-11-02           0
## 2012-11-03           0
## 2012-11-04          NA
## 2012-11-05           0
## 2012-11-06           0
## 2012-11-07           0
## 2012-11-08           0
## 2012-11-09          NA
## 2012-11-10          NA
## 2012-11-11           0
## 2012-11-12           0
## 2012-11-13           0
## 2012-11-14          NA
## 2012-11-15           0
## 2012-11-16           0
## 2012-11-17           0
## 2012-11-18           0
## 2012-11-19           0
## 2012-11-20           0
## 2012-11-21           0
## 2012-11-22           0
## 2012-11-23           0
## 2012-11-24           0
## 2012-11-25           0
## 2012-11-26           0
## 2012-11-27           0
## 2012-11-28           0
## 2012-11-29           0
## 2012-11-30          NA
```

## What is the average daily activity pattern?

```r
# install.packages("lubridate")
library(lubridate)
```

```
## 
## Attaching package: 'lubridate'
```

```
## The following objects are masked from 'package:base':
## 
##     date, intersect, setdiff, union
```

```r
df <- ts(meansteps, start = decimal_date(as.Date("2012-10-01")), frequency = 365)
plot(df)
```

![](PA1_template_files/figure-html/unnamed-chunk-1-1.png)<!-- -->

```r
meansteps2 <- data.frame(meanSteps=tapply(data$steps, data$interval, mean, na.rm=TRUE))
meansteps2$interval <- row.names(meansteps2)
#The maximum number of steps is contained in this 5-minutes interval:
meansteps2[which.max(meansteps2$meanSteps),"interval"]
```

```
## [1] "835"
```

## Imputing missing values

```r
# The total number of missing values is:
sum(!complete.cases(data))
```

```
## [1] 2304
```

```r
datasteps2 <- merge(data, meansteps2, "interval")
datasteps2[is.na(datasteps2$steps),]$steps <- datasteps2[is.na(datasteps2$steps),]$meanSteps
datasteps2$meanSteps <- NULL
datasteps2 <- datasteps2[,c("steps", "date", "interval")]
# This dataset is like the first one but after imputing missing values by the mean (interval):
head(datasteps2)
```

```
##      steps       date interval
## 1 1.716981 2012-10-01        0
## 2 0.000000 2012-11-23        0
## 3 0.000000 2012-10-28        0
## 4 0.000000 2012-11-06        0
## 5 0.000000 2012-11-24        0
## 6 0.000000 2012-11-15        0
```

```r
totalsteps2 <- data.frame(totalSteps=tapply(datasteps2$steps, datasteps2$date, sum, na.rm=TRUE))
hist(totalsteps2$totalSteps)
```

![](PA1_template_files/figure-html/unnamed-chunk-2-1.png)<!-- -->

```r
data.frame(meanSteps=tapply(datasteps2$steps, datasteps2$date, mean, na.rm=TRUE))
```

```
##             meanSteps
## 2012-10-01 37.3825996
## 2012-10-02  0.4375000
## 2012-10-03 39.4166667
## 2012-10-04 42.0694444
## 2012-10-05 46.1597222
## 2012-10-06 53.5416667
## 2012-10-07 38.2465278
## 2012-10-08 37.3825996
## 2012-10-09 44.4826389
## 2012-10-10 34.3750000
## 2012-10-11 35.7777778
## 2012-10-12 60.3541667
## 2012-10-13 43.1458333
## 2012-10-14 52.4236111
## 2012-10-15 35.2048611
## 2012-10-16 52.3750000
## 2012-10-17 46.7083333
## 2012-10-18 34.9166667
## 2012-10-19 41.0729167
## 2012-10-20 36.0937500
## 2012-10-21 30.6284722
## 2012-10-22 46.7361111
## 2012-10-23 30.9652778
## 2012-10-24 29.0104167
## 2012-10-25  8.6527778
## 2012-10-26 23.5347222
## 2012-10-27 35.1354167
## 2012-10-28 39.7847222
## 2012-10-29 17.4236111
## 2012-10-30 34.0937500
## 2012-10-31 53.5208333
## 2012-11-01 37.3825996
## 2012-11-02 36.8055556
## 2012-11-03 36.7048611
## 2012-11-04 37.3825996
## 2012-11-05 36.2465278
## 2012-11-06 28.9375000
## 2012-11-07 44.7326389
## 2012-11-08 11.1770833
## 2012-11-09 37.3825996
## 2012-11-10 37.3825996
## 2012-11-11 43.7777778
## 2012-11-12 37.3784722
## 2012-11-13 25.4722222
## 2012-11-14 37.3825996
## 2012-11-15  0.1423611
## 2012-11-16 18.8923611
## 2012-11-17 49.7881944
## 2012-11-18 52.4652778
## 2012-11-19 30.6979167
## 2012-11-20 15.5277778
## 2012-11-21 44.3993056
## 2012-11-22 70.9270833
## 2012-11-23 73.5902778
## 2012-11-24 50.2708333
## 2012-11-25 41.0902778
## 2012-11-26 38.7569444
## 2012-11-27 47.3819444
## 2012-11-28 35.3576389
## 2012-11-29 24.4687500
## 2012-11-30 37.3825996
```

```r
data.frame(medianSteps=tapply(totalsteps2$totalSteps, totalsteps2$totalSteps, median, na.rm=TRUE))
```

```
##                  medianSteps
## 41                     41.00
## 126                   126.00
## 2492                 2492.00
## 3219                 3219.00
## 4472                 4472.00
## 5018                 5018.00
## 5441                 5441.00
## 6778                 6778.00
## 7047                 7047.00
## 7336                 7336.00
## 8334                 8334.00
## 8355                 8355.00
## 8821                 8821.00
## 8841                 8841.00
## 8918                 8918.00
## 9819                 9819.00
## 9900                 9900.00
## 10056               10056.00
## 10119               10119.00
## 10139               10139.00
## 10183               10183.00
## 10304               10304.00
## 10395               10395.00
## 10439               10439.00
## 10571               10571.00
## 10600               10600.00
## 10765               10765.00
## 10766.1886792453    10766.19
## 11015               11015.00
## 11162               11162.00
## 11352               11352.00
## 11458               11458.00
## 11829               11829.00
## 11834               11834.00
## 12116               12116.00
## 12426               12426.00
## 12608               12608.00
## 12787               12787.00
## 12811               12811.00
## 12883               12883.00
## 13294               13294.00
## 13452               13452.00
## 13460               13460.00
## 13646               13646.00
## 14339               14339.00
## 14478               14478.00
## 15084               15084.00
## 15098               15098.00
## 15110               15110.00
## 15414               15414.00
## 15420               15420.00
## 17382               17382.00
## 20427               20427.00
## 21194               21194.00
```
Mean and median are higher in this case, because replacing "NA" or missing steps (in which the value was 0) into the median of the steps (a numeric value different from 0), the result has to be higher.

## Are there differences in activity patterns between weekdays and weekends?

```r
datasteps2$weekday <- weekdays(as.Date(datasteps2$date))
datasteps2$day <- ifelse(datasteps2$weekday%in%c("sÃ¡bado", "domingo"), "weekend", "weekday" )
averages <- aggregate(steps ~ interval + day, data=datasteps2, mean)
par(mfrow=c(2,1))
plot(averages[averages$day=="weekday",]$steps, type="l", xlab="5-minute interval", ylab="Number of steps", main="weekday")
plot(averages[averages$day=="weekend",]$steps, type="l", xlab="5-minute interval", ylab="Number of steps", main="weekend")
```

![](PA1_template_files/figure-html/weekday or weekend-1.png)<!-- -->
